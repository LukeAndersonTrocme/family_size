library(dplyr)
library(data.table)
library(ggplot2)
infile <- fread("/Users/luke/Documents/family_size/Saguenay_ind_relative_family_size.csv")
infile
infile$fifty <- pedigree$decade - pedigree$decade %% 50
infile$fifty <- infile$decade - infile$decade %% 50
infile
(infile %>% filter(is.na(grand))
infile %>% filter(is.na(grand))
infile
infile %>% filter(grand=="")
infile <- fread("/Users/luke/Documents/family_size/Saguenay_ind_relative_family_size.csv") %>%
group_by(ind, focal_family_size, t, min_wts_name, decade, great, grand) %>%
dplyr::summarise(relative_family_size = mean(relative_family_size))
infile$fifty <- infile$decade - infile$decade %% 50
infile
op <-
ggplot(infile) +
geom_jitter(aes(x = focal_family_size, y = relative_family_size)
size = 0.1) +
op <-
ggplot(infile) +
geom_jitter(aes(x = focal_family_size, y = relative_family_size),
size = 0.1) +
theme_bw() +
facet_grid(fifty ~ great + grand)
op
op <-
ggplot(infile) +
geom_jitter(aes(x = focal_family_size, y = relative_family_size),
size = 0.01) +
theme_bw() +
scale_c_continuous(limits = c(0,30))+
scale_y_continuous(limits = c(0,30))+
facet_grid(fifty ~ great + grand)
op <-
ggplot(infile) +
geom_jitter(aes(x = focal_family_size, y = relative_family_size),
size = 0.01) +
theme_bw() +
scale_x_continuous(limits = c(0,30))+
scale_y_continuous(limits = c(0,30))+
facet_grid(fifty ~ great + grand)
op
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(name),lm_eqn)
library(dplyr)
library(data.table)
library(ggplot2)
library(plyr) # r2 formula
library(ggpmisc) # r2 formula on plot
library(cowplot) # multi panel plot
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(name),lm_eqn)
infile$group <- paste0(infile$fifty,infile$great,infile$grand)
infile
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(group),lm_eqn)
plot_df <- inner_join(eq, infile)
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = mean(HR_response, na.rm = T), lab_y = max(value, na.rm = T) + (max(value, na.rm = T)/5))
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(group),lm_eqn)
plot_df <- inner_join(eq, infile)
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = mean(focal_family_size, na.rm = T), lab_y = max(relative_family_size, na.rm = T) + (max(relative_family_size, na.rm = T)/5))
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_point()+theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_point()+theme_bw()
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_point()+theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed))
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(group),lm_eqn)
plot_df <- inner_join(eq, infile)
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = mean(focal_family_size, na.rm = T), lab_y = max(relative_family_size, na.rm = T) + (max(relative_family_size, na.rm = T)/5))
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_point()+theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_point()+theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed))
plot_df
label_df
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_point()+theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
infile$group <- paste0("test",infile$great,infile$grand,infile$fifty)
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(group),lm_eqn)
plot_df <- inner_join(eq, infile)
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = mean(focal_family_size, na.rm = T), lab_y = max(relative_family_size, na.rm = T) + (max(relative_family_size, na.rm = T)/5))
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_point()+theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_point()+theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
infile <- fread("/Users/luke/Documents/family_size/Saguenay_ind_relative_family_size.csv") %>%
group_by(ind, focal_family_size, t, min_wts_name, decade, great, grand) %>%
dplyr::summarise(relative_family_size = mean(relative_family_size))
infile$fifty <- infile$decade - infile$decade %% 50
infile$group <- paste0(infile$great,infile$grand,"parents_",infile$fifty)
infile
infile %>% filter(is.na(fifty))
infile <- fread("/Users/luke/Documents/family_size/Saguenay_ind_relative_family_size.csv") %>%
filter(!is.na(decade)) %>%
group_by(ind, focal_family_size, t, min_wts_name, decade, great, grand) %>%
dplyr::summarise(relative_family_size = mean(relative_family_size))
infile$fifty <- infile$decade - infile$decade %% 50
infile$group <- paste0(infile$great,infile$grand,"parents_",infile$fifty)
infile
infile %>% filter(is.na(fifty))
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(group),lm_eqn)
plot_df <- inner_join(eq, infile)
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = mean(focal_family_size, na.rm = T), lab_y = max(relative_family_size, na.rm = T) + (max(relative_family_size, na.rm = T)/5))
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_point()+theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
geom_jitter(size = 0.01)+theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
op
infile <- fread("/Users/luke/Documents/family_size/Saguenay_ind_relative_family_size.csv") %>%
filter(!is.na(decade)) %>%
group_by(ind, focal_family_size, t, min_wts_name, decade, great, grand) %>%
dplyr::summarise(relative_family_size = mean(relative_family_size))
infile$fifty <- infile$decade - infile$decade %% 50
infile$group <- paste0(infile$great,"",infile$grand,"","parents_",infile$fifty)
infile
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(group),lm_eqn)
plot_df <- inner_join(eq, infile)
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = mean(focal_family_size, na.rm = T), lab_y = max(relative_family_size, na.rm = T) + (max(relative_family_size, na.rm = T)/5))
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
op
infile$group <- paste0(infile$great,"_",infile$grand,"_","parents_",infile$fifty)
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(group),lm_eqn)
plot_df <- inner_join(eq, infile)
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = mean(focal_family_size, na.rm = T), lab_y = max(relative_family_size, na.rm = T) + (max(relative_family_size, na.rm = T)/5))
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
op
infile$group <- paste0(infile$great,".",infile$grand,".","parents_",infile$fifty)
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
eq <- ddply(infile %>% dplyr::rename(x = focal_family_size, y = relative_family_size),.(group),lm_eqn)
plot_df <- inner_join(eq, infile)
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = mean(focal_family_size, na.rm = T), lab_y = max(relative_family_size, na.rm = T) + (max(relative_family_size, na.rm = T)/5))
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
op
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
scale_x_continuous(limits = (0,30))+
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
scale_x_continuous(limits = (0,30))+
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
scale_x_continuous(limits = c(0,30))+
scale_y_continuous(limits = c(0,30))+
theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
op
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = 20, lab_y = 20)
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
scale_x_continuous(limits = c(0,30))+
scale_y_continuous(limits = c(0,30))+
theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
op
label_df <- plot_df %>% group_by(group, V1) %>% dplyr::summarise(lab_x = 15, lab_y = 29)
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
scale_x_continuous(limits = c(0,30))+
scale_y_continuous(limits = c(0,30))+
theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE)
op
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
scale_x_continuous(limits = c(0,30))+
scale_y_continuous(limits = c(0,30))+
theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE) +
ggtitle("Saguenay") +
theme(plot.title = element_text(hjust = 0.5))
ggsave(op, filename = "/Users/luke/Documents/family_size/Saguenay_ind_relative_family_size.jpg", height = 10, width = 14)
ggsave(op, filename = "/Users/luke/Documents/family_size/Saguenay_ind_relative_family_size.jpg", height = 8, width = 12)
op <-
ggplot(infile,
aes(x = focal_family_size, y = relative_family_size)) +
geom_jitter(size = 0.01)+
geom_smooth(method = "lm", se=FALSE, color="royalblue", formula = y ~ x, size = 0.3) +
scale_x_continuous(limits = c(0,30))+
scale_y_continuous(limits = c(0,30))+
theme_bw() +
facet_wrap(.~group, scales = "free_y", labeller = as_labeller(eq,
default = label_parsed)) +
geom_text(data = label_df, aes(x = lab_x, y = lab_y, label=V1), parse = TRUE, inherit.aes=FALSE) +
ggtitle("Saguenay") +
theme(plot.title = element_text(hjust = 0.5))
ggsave(op, filename = "/Users/luke/Documents/family_size/Saguenay_ind_relative_family_size.jpg", height = 8, width = 12)
